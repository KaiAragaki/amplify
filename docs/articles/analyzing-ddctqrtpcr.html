<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="amplify">
<title>Analyzing ddCt qPCR with amplify • amplify</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing ddCt qPCR with amplify">
<meta property="og:description" content="amplify">
<meta property="og:image" content="https://kaiaragaki.github.io/amplify/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">amplify</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/analyzing-ddctqrtpcr.html">Analyzing ddCt qPCR with amplify</a>
    <a class="dropdown-item" href="../articles/performing-lib-quant-qc.html">Performing Library Quantification QC</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">

<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Analyzing ddCt qPCR with amplify</h1>
            
      
      
      <div class="d-none name"><code>analyzing-ddctqrtpcr.Rmd</code></div>
    </div>

    
    
<div class="section level1">
<h1 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h1>
<p>PCR data appear to be simple to work with at the outset - QuantStudio can output barcharts, and it even readily outputs the data in tabular formats. However, some tasks, like omitting a particular measurement, no longer make the results valid. One must remember to omit it in QuantStudio, recalculate the values, then plot the results - or risk having an inaccurate plot!</p>
<p>Additionally, the plots output by QuantStudio are fairly ugly and inflexible. Outputting them is tedious, as is rearranging columns.</p>
<p>In this vignette, I’ll perform a routine analysis on a rather untidy dataset using the <code>pcr_*</code> suite of functions. The <code>pcr_*</code> suite of functions seek to make life a little easier and a lot more reproducible by allowing many of the previously QuantStudio specific tasks to be done in R.</p>
</div>
<div class="section level1">
<h1 id="reading-in-data">Reading in Data<a class="anchor" aria-label="anchor" href="#reading-in-data"></a>
</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">amplify</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></code></pre></div>
<p>We have a particular advantage because although the data are untidy, they are untidy in a very specific way. Reading in data is as simple as running <code>pcr_tidy</code>, which is given a path to the pcr .xls(x) file. If no path is given, an interactive file explorer window will appear for the user to choose the file.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"untidy-pcr-example-2.xlsx"</span>, package <span class="op">=</span> <span class="st">"amplify"</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="../reference/pcr_tidy.html">pcr_tidy</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">dat</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 159 x 40</span></span>
<span class="co">#&gt;    well  well_position omit  sample_name target_name task    reporter quencher</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2     A2            FALSE UC3 PBS     CDH1        UNKNOWN FAM      NFQ-MGB </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 3     A3            FALSE UC3 PBS     CDH1        UNKNOWN FAM      NFQ-MGB </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 4     A4            FALSE UC3 Drug    CDH1        UNKNOWN FAM      NFQ-MGB </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 5     A5            FALSE UC3 Drug    CDH1        UNKNOWN FAM      NFQ-MGB </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 6     A6            FALSE UC3 Drug    CDH1        UNKNOWN FAM      NFQ-MGB </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 7     A7            FALSE T24 PBS     CDH1        UNKNOWN FAM      NFQ-MGB </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 8     A8            FALSE T24 PBS     CDH1        UNKNOWN FAM      NFQ-MGB </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 9     A9            FALSE T24 PBS     CDH1        UNKNOWN FAM      NFQ-MGB </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 10    A10           FALSE T24 Drug    CDH1        UNKNOWN FAM      NFQ-MGB </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 11    A11           FALSE T24 Drug    CDH1        UNKNOWN FAM      NFQ-MGB </span>
<span class="co">#&gt; <span style="color: #949494;"># ... with 149 more rows, and 32 more variables: quantity &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   quantity_mean &lt;dbl&gt;, quantity_sd &lt;dbl&gt;, rq &lt;dbl&gt;, rq_min &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   rq_max &lt;dbl&gt;, ct &lt;dbl&gt;, ct_mean &lt;dbl&gt;, ct_sd &lt;dbl&gt;, delta_ct &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   delta_ct_mean &lt;dbl&gt;, delta_ct_sd &lt;dbl&gt;, delta_ct_se &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   delta_delta_ct &lt;dbl&gt;, automatic_ct_threshold &lt;lgl&gt;, ct_threshold &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   automatic_baseline &lt;lgl&gt;, baseline_start &lt;dbl&gt;, baseline_end &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   comments &lt;chr&gt;, expfail &lt;chr&gt;, highsd &lt;chr&gt;, noamp &lt;chr&gt;, ...</span></span></code></pre></div>
<p>The typical format of PCR data is woefully non-rectangular. <code>pcr_tidy</code> fixes this by skipping to the good bits, but also pulling out useful metadata supplied in the header and footer of the dataset - like the last few columns:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">plate_type</span><span class="op">:</span><span class="va">ref_samp</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 159 x 2</span></span>
<span class="co">#&gt;    plate_type     ref_samp  </span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 384-Well Block RT112 Drug</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 384-Well Block RT112 Drug</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 384-Well Block RT112 Drug</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 384-Well Block RT112 Drug</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 384-Well Block RT112 Drug</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 384-Well Block RT112 Drug</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 384-Well Block RT112 Drug</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 384-Well Block RT112 Drug</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 384-Well Block RT112 Drug</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 384-Well Block RT112 Drug</span>
<span class="co">#&gt; <span style="color: #949494;"># ... with 149 more rows</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="plate-plotting-with-pcr_plate_view">Plate Plotting with <code>pcr_plate_view</code><a class="anchor" aria-label="anchor" href="#plate-plotting-with-pcr_plate_view"></a>
</h1>
<p><code>pcr_tidy</code> also adds two features derived from the <code>well_position</code> feature into two separate features - <code>well_row</code> and <code>well_col</code>. This makes downstream plotting particularly easy. A built in function can do this automatically for us:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pcr_plate_view.html">pcr_plate_view</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></code></pre></div>
<p><img src="analyzing-ddctqrtpcr_files/figure-html/plot_plate_target-1.png" width="100%"></p>
<p>This high level overview lets us see there’s something curious going on with A1. Additionally, some wells at the bottom - likely non-targeting controls - only have two instead of three wells ascribed to them.</p>
<p>What about the <em>sample</em> layout?</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pcr_plate_view.html">pcr_plate_view</a></span><span class="op">(</span><span class="va">dat</span>, <span class="st">"sample_name"</span><span class="op">)</span></code></pre></div>
<p><img src="analyzing-ddctqrtpcr_files/figure-html/plot_plate_sample-1.png" width="100%"></p>
<p>We can also look at CT:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pcr_plate_view.html">pcr_plate_view</a></span><span class="op">(</span><span class="va">dat</span>, fill <span class="op">=</span> <span class="st">"ct"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="analyzing-ddctqrtpcr_files/figure-html/plot_plate_ct-1.png" width="100%"></p>
<p>Looks like some didn’t amplify at all. You might consider looking at it with <code>rq</code> but…</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pcr_plate_view.html">pcr_plate_view</a></span><span class="op">(</span><span class="va">dat</span>, fill <span class="op">=</span> <span class="st">"rq"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="analyzing-ddctqrtpcr_files/figure-html/plot_plate_rq-1.png" width="100%"></p>
<p>Immediately we see a loss of information: Not only are the scales between cell lines wildly different, but some of the targets aren’t even there! What’s going on?</p>
<p>If we remember back, our reference sample was RT112, which does not appear to express one of the targets at all. Therefore a quantity relative to 0 doesn’t make any sense!</p>
</div>
<div class="section level1">
<h1 id="expression-plotting-with-pcr_plot">Expression Plotting with <code>pcr_plot</code><a class="anchor" aria-label="anchor" href="#expression-plotting-with-pcr_plot"></a>
</h1>
<p>We can naively plot all of the data at once using <code>pcr_plot</code></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pcr_plot.html">pcr_plot</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 24 rows containing missing values (position_stack).</span></code></pre></div>
<p><img src="analyzing-ddctqrtpcr_files/figure-html/unnamed-chunk-3-1.png" width="100%"></p>
<p>We notice the differences between cell lines, but the large dynamic range makes it difficult to look at differences between conditions. We can split the data up by cell line and then recalculate rqs individually.</p>
</div>
<div class="section level1">
<h1 id="rescaling-data-with-pcr_rq">Rescaling Data with <code>pcr_rq</code><a class="anchor" aria-label="anchor" href="#rescaling-data-with-pcr_rq"></a>
</h1>
<p>First, we need to extract the cell line from the sample name. Additionally, I don’t like how it says “Zeb1” and “Zeb2” instead of “ZEB1” and “ZEB2” (the capitalization may mislead people into thinking this is murine, when it is in fact human). I’ll change that here.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span> |&gt; 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cell_line <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html" class="external-link">str_extract</a></span><span class="op">(</span><span class="va">sample_name</span>, <span class="st">"^.*(?=[:space:])"</span><span class="op">)</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>target_name <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html" class="external-link">str_replace</a></span><span class="op">(</span><span class="va">target_name</span>, <span class="st">"Zeb"</span>, <span class="st">"ZEB"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>As an example, let’s look at UC14:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">uc14</span> <span class="op">&lt;-</span> <span class="va">dat</span> |&gt; 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cell_line</span> <span class="op">==</span> <span class="st">"UC14"</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="../reference/pcr_rq.html">pcr_rq</a></span><span class="op">(</span><span class="st">"UC14 PBS"</span><span class="op">)</span>

<span class="fu"><a href="../reference/pcr_plot.html">pcr_plot</a></span><span class="op">(</span><span class="va">uc14</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 rows containing missing values (position_stack).</span></code></pre></div>
<p><img src="analyzing-ddctqrtpcr_files/figure-html/unnamed-chunk-5-1.png" width="100%"></p>
<p>I personally prefer it when the control is on the left and the experimental conditions are on the right - let’s flip them. While we’re at it, let’s get rid of the legend - it doesn’t tell us any extra information and is just taking up space.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">uc14</span> <span class="op">&lt;-</span> <span class="va">uc14</span> |&gt; 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sample_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sample_name</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UC14 PBS"</span>, <span class="st">"UC14 Drug"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="../reference/pcr_plot.html">pcr_plot</a></span><span class="op">(</span><span class="va">uc14</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 rows containing missing values (position_stack).</span></code></pre></div>
<p><img src="analyzing-ddctqrtpcr_files/figure-html/unnamed-chunk-6-1.png" width="100%"></p>
<p>The same kind of reorganization can be done with <code>target_names</code> as well - if you wanted to put the control target (here PPIA) at the end.</p>
</div>
<div class="section level1">
<h1 id="ommiting-a-case">Ommiting a case<a class="anchor" aria-label="anchor" href="#ommiting-a-case"></a>
</h1>
<p>Suppose you have reason to believe that one of your colleagues (or perhaps you yourself) spit into your C22 well (the spit was very accurate). If we naively remove it, this is what we get:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">naive</span> <span class="op">&lt;-</span> <span class="va">uc14</span> |&gt; 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">well_position</span> <span class="op">!=</span> <span class="st">"C24"</span><span class="op">)</span>

<span class="fu"><a href="../reference/pcr_plot.html">pcr_plot</a></span><span class="op">(</span><span class="va">naive</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 rows containing missing values (position_stack).</span></code></pre></div>
<p><img src="analyzing-ddctqrtpcr_files/figure-html/unnamed-chunk-7-1.png" width="100%"></p>
<p>Umm…it doesn’t look any different. And that’s what we should expect: the plotting function doesn’t do any calculations: <strong>It only plots the values already stored within it.</strong> To get updated values, we need to use <code>pcr_rq</code> again:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wise</span> <span class="op">&lt;-</span> <span class="va">uc14</span> |&gt; 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">well_position</span> <span class="op">!=</span> <span class="st">"C24"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/pcr_rq.html">pcr_rq</a></span><span class="op">(</span><span class="st">"UC14 PBS"</span><span class="op">)</span>

<span class="fu"><a href="../reference/pcr_plot.html">pcr_plot</a></span><span class="op">(</span><span class="va">wise</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 rows containing missing values (position_stack).</span></code></pre></div>
<p><img src="analyzing-ddctqrtpcr_files/figure-html/unnamed-chunk-8-1.png" width="100%"></p>
<p>Now, we see that the ZEB1 values have updated to reflect the ommision we made.</p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Kai Aragaki.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
