<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Performing Library Quantification QC • amplify</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Performing Library Quantification QC">
<meta property="og:description" content="amplify">
<meta property="og:image" content="https://kaiaragaki.github.io/amplify/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">amplify</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/analyzing-ddctqrtpcr.html">Analyzing ddCt qPCR with amplify</a>
    </li>
    <li>
      <a href="../articles/performing-lib-quant-qc.html">Performing Library Quantification QC</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="performing-lib-quant-qc_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Performing Library Quantification QC</h1>
            
      
      
      <div class="hidden name"><code>performing-lib-quant-qc.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">amplify</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></code></pre></div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>When RNA libraries are generated, their absolute concentrations need to be established so they can be evenly loaded onto the chip with the correct concentration. In order to measure RNA library concentration, qPCR with a standard curve is performed. amplify offers several functions to both:</p>
<ol style="list-style-type: decimal">
<li>Determine the quality of the assay and, if the assay went well,</li>
<li>Determine the concentration of RNA libraries.</li>
</ol>
</div>
<div id="reading-and-tidying-data" class="section level1">
<h1 class="hasAnchor">
<a href="#reading-and-tidying-data" class="anchor"></a>Reading and Tidying Data</h1>
<p>amplify takes ‘results’ (<code>.xls(x)</code>) files exported from QuantStudio. They can be tidied easily by providing a path to <code>pcr_tidy</code>. We also add <code>pad_zero = TRUE</code>, which changes the default value of, say <code>Sample 1</code> to <code>Sample 01</code>. This will help with out plotting order down the line.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tidy_lib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"untidy-standard-curve.xlsx"</span>, package <span class="op">=</span> <span class="st">"amplify"</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="../reference/pcr_tidy.html">pcr_tidy</a></span><span class="op">(</span>pad_zero <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">tidy_lib</span> |&gt; 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 10</span>
<span class="co">#&gt;   well  well_position omit  sample_name target_name task     reporter quencher</span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;         &lt;lgl&gt; &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;   </span>
<span class="co">#&gt; 1 1     A1            FALSE Standard 01 Target 1    STANDARD FAM      NFQ-MGB </span>
<span class="co">#&gt; 2 2     A2            FALSE Standard 01 Target 1    STANDARD FAM      NFQ-MGB </span>
<span class="co">#&gt; 3 3     A3            FALSE Standard 01 Target 1    STANDARD FAM      NFQ-MGB </span>
<span class="co">#&gt; 4 5     A5            FALSE Sample 01   Target 1    UNKNOWN  FAM      NFQ-MGB </span>
<span class="co">#&gt; 5 6     A6            FALSE Sample 01   Target 1    UNKNOWN  FAM      NFQ-MGB </span>
<span class="co">#&gt; 6 8     A8            FALSE Sample 09   Target 1    UNKNOWN  FAM      NFQ-MGB </span>
<span class="co">#&gt; # … with 2 more variables: ct &lt;dbl&gt;, ct_mean &lt;dbl&gt;</span></code></pre></div>
<p>By default, <code>pcr_tidy</code> assumes you have a standards serial dilution starting at 6.8, diluted by a factor of 10, going all the way down to 0.00068, and that you want all of them. There are a couple instances in which this might not be the case:</p>
<ol style="list-style-type: decimal">
<li>You have a different serial dilution</li>
<li>You want to remove some particularly heinous standards that will throw off slope calculation if included</li>
</ol>
<p>In that instance, you would supply a numeric vector to the <code>usr_standards</code> argument. If you wish to omit a given set of standards, simply do not include them in this vector:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"untidy-standard-curve.xlsx"</span>, package <span class="op">=</span> <span class="st">"amplify"</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="../reference/pcr_tidy.html">pcr_tidy</a></span><span class="op">(</span>pad_zero <span class="op">=</span> <span class="cn">TRUE</span>, usr_standards <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6.8</span>, <span class="fl">.68</span>, <span class="fl">.068</span>, <span class="fl">.0068</span><span class="op">)</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; 2 rows of standards did not have a matching value in 'standards' and have been dropped</span>
<span class="co">#&gt; # A tibble: 6 × 10</span>
<span class="co">#&gt;   well  well_position omit  sample_name target_name task     reporter quencher</span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;         &lt;lgl&gt; &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;   </span>
<span class="co">#&gt; 1 1     A1            FALSE Standard 01 Target 1    STANDARD FAM      NFQ-MGB </span>
<span class="co">#&gt; 2 2     A2            FALSE Standard 01 Target 1    STANDARD FAM      NFQ-MGB </span>
<span class="co">#&gt; 3 3     A3            FALSE Standard 01 Target 1    STANDARD FAM      NFQ-MGB </span>
<span class="co">#&gt; 4 5     A5            FALSE Sample 01   Target 1    UNKNOWN  FAM      NFQ-MGB </span>
<span class="co">#&gt; 5 6     A6            FALSE Sample 01   Target 1    UNKNOWN  FAM      NFQ-MGB </span>
<span class="co">#&gt; 6 8     A8            FALSE Sample 09   Target 1    UNKNOWN  FAM      NFQ-MGB </span>
<span class="co">#&gt; # … with 2 more variables: ct &lt;dbl&gt;, ct_mean &lt;dbl&gt;</span></code></pre></div>
<p>This will automatically update the slope column of the dataframe as well. This can be called standalone (say, after manually removing a few standards replicates from your dataset) by running <code>pcr_calc_slope</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">recalc</span> <span class="op">&lt;-</span> <span class="va">tidy_lib</span> |&gt; 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">quantity</span> <span class="op">&gt;</span> <span class="fl">0.0068</span> <span class="op">|</span> <span class="va">task</span> <span class="op">!=</span> <span class="st">"STANDARD"</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="../reference/pcr_calc_slope.html">pcr_calc_slope</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">recalc</span><span class="op">$</span><span class="va">slope</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="co">#&gt; [1] -3.430141</span>
<span class="va">tidy_lib</span><span class="op">$</span><span class="va">slope</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="co">#&gt; [1] -3.4827</span></code></pre></div>
</div>
<div id="calculating-library-concentration" class="section level1">
<h1 class="hasAnchor">
<a href="#calculating-library-concentration" class="anchor"></a>Calculating Library Concentration</h1>
<p>Before we can perform quality control, we first need to calculate the concentration of RNA library in our samples. We supply a dilution factor to calculate the concentration of the original libraries from the concentration of libraries in the assay (here we diluted them 1:1000).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lib_conc</span> <span class="op">&lt;-</span> <span class="va">tidy_lib</span> |&gt; 
  <span class="fu"><a href="../reference/pcr_lib_calc.html">pcr_lib_calc</a></span><span class="op">(</span>dil_factor <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>

<span class="va">lib_conc</span> |&gt;
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">sample_name</span>, <span class="va">concentration</span><span class="op">)</span>
<span class="co">#&gt; Adding missing grouping variables: `task`</span>
<span class="co">#&gt; # A tibble: 58 × 3</span>
<span class="co">#&gt; # Groups:   task [3]</span>
<span class="co">#&gt;    task     sample_name concentration</span>
<span class="co">#&gt;    &lt;chr&gt;    &lt;chr&gt;               &lt;dbl&gt;</span>
<span class="co">#&gt;  1 STANDARD Standard 01           NA </span>
<span class="co">#&gt;  2 STANDARD Standard 01           NA </span>
<span class="co">#&gt;  3 STANDARD Standard 01           NA </span>
<span class="co">#&gt;  4 UNKNOWN  Sample 06           2039.</span>
<span class="co">#&gt;  5 UNKNOWN  Sample 06           2039.</span>
<span class="co">#&gt;  6 UNKNOWN  Sample 06           2039.</span>
<span class="co">#&gt;  7 UNKNOWN  Sample 12           1893.</span>
<span class="co">#&gt;  8 UNKNOWN  Sample 12           1893.</span>
<span class="co">#&gt;  9 UNKNOWN  Sample 12           1893.</span>
<span class="co">#&gt; 10 UNKNOWN  Sample 04           1694.</span>
<span class="co">#&gt; # … with 48 more rows</span></code></pre></div>
</div>
<div id="generating-quality-control-data" class="section level1">
<h1 class="hasAnchor">
<a href="#generating-quality-control-data" class="anchor"></a>Generating Quality Control Data</h1>
<p>Quality control metrics also need to be calculated. We can do this by calling <code>pcr_lib_qc</code> on data output from <code>pcr_lib_calc</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lib_qc</span> <span class="op">&lt;-</span> <span class="va">lib_conc</span> |&gt; 
  <span class="fu"><a href="../reference/pcr_lib_qc.html">pcr_lib_qc</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">lib_qc</span>
<span class="co">#&gt; $standards</span>
<span class="co">#&gt; # A tibble: 13 × 19</span>
<span class="co">#&gt; # Groups:   sample_name [5]</span>
<span class="co">#&gt;    sample_name task     quantity_mean concentration quantity quant_actual   dil</span>
<span class="co">#&gt;    &lt;chr&gt;       &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 Standard 01 STANDARD            NA            NA 6.80         6.80      0   </span>
<span class="co">#&gt;  2 Standard 01 STANDARD            NA            NA 6.80         6.80      0   </span>
<span class="co">#&gt;  3 Standard 01 STANDARD            NA            NA 6.80         6.80      0   </span>
<span class="co">#&gt;  4 Standard 02 STANDARD            NA            NA 0.680        0.734     9.27</span>
<span class="co">#&gt;  5 Standard 02 STANDARD            NA            NA 0.680        0.734     9.27</span>
<span class="co">#&gt;  6 Standard 03 STANDARD            NA            NA 0.0680       0.0603   12.2 </span>
<span class="co">#&gt;  7 Standard 03 STANDARD            NA            NA 0.0680       0.0603   12.2 </span>
<span class="co">#&gt;  8 Standard 03 STANDARD            NA            NA 0.0680       0.0603   12.2 </span>
<span class="co">#&gt;  9 Standard 04 STANDARD            NA            NA 0.00680      0.00568  10.6 </span>
<span class="co">#&gt; 10 Standard 04 STANDARD            NA            NA 0.00680      0.00568  10.6 </span>
<span class="co">#&gt; 11 Standard 04 STANDARD            NA            NA 0.00680      0.00568  10.6 </span>
<span class="co">#&gt; 12 Standard 05 STANDARD            NA            NA 0.000680     0.000417 13.6 </span>
<span class="co">#&gt; 13 Standard 05 STANDARD            NA            NA 0.000680     0.000417 13.6 </span>
<span class="co">#&gt; # … with 12 more variables: slope &lt;dbl&gt;, efficiency &lt;dbl&gt;, r2 &lt;dbl&gt;, ct &lt;dbl&gt;,</span>
<span class="co">#&gt; #   no_po_mean &lt;dbl&gt;, no_po_sd &lt;dbl&gt;, keep &lt;lgl&gt;, keep_temp &lt;lgl&gt;,</span>
<span class="co">#&gt; #   mean_adj &lt;dbl&gt;, sd_adj &lt;dbl&gt;, quant_adj &lt;dbl&gt;, z &lt;dbl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $samples</span>
<span class="co">#&gt; # A tibble: 42 × 19</span>
<span class="co">#&gt; # Groups:   sample_name [16]</span>
<span class="co">#&gt;    sample_name task    quantity_mean concentration quantity quant_actual   dil</span>
<span class="co">#&gt;    &lt;chr&gt;       &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 Sample 06   UNKNOWN          2.04         2039.     2.06         2.06    NA</span>
<span class="co">#&gt;  2 Sample 06   UNKNOWN          2.04         2039.     2.12         2.12    NA</span>
<span class="co">#&gt;  3 Sample 06   UNKNOWN          2.04         2039.     1.94         1.94    NA</span>
<span class="co">#&gt;  4 Sample 12   UNKNOWN          1.89         1893.     1.93         1.93    NA</span>
<span class="co">#&gt;  5 Sample 12   UNKNOWN          1.89         1893.     1.88         1.88    NA</span>
<span class="co">#&gt;  6 Sample 12   UNKNOWN          1.89         1893.     1.87         1.87    NA</span>
<span class="co">#&gt;  7 Sample 04   UNKNOWN          1.69         1694.     1.62         1.62    NA</span>
<span class="co">#&gt;  8 Sample 04   UNKNOWN          1.69         1694.     1.84         1.84    NA</span>
<span class="co">#&gt;  9 Sample 04   UNKNOWN          1.69         1694.     1.62         1.62    NA</span>
<span class="co">#&gt; 10 Sample 16   UNKNOWN          1.49         1493.     1.46         1.46    NA</span>
<span class="co">#&gt; # … with 32 more rows, and 12 more variables: slope &lt;dbl&gt;, efficiency &lt;dbl&gt;,</span>
<span class="co">#&gt; #   r2 &lt;dbl&gt;, ct &lt;dbl&gt;, no_po_mean &lt;dbl&gt;, no_po_sd &lt;dbl&gt;, keep &lt;lgl&gt;,</span>
<span class="co">#&gt; #   keep_temp &lt;lgl&gt;, mean_adj &lt;dbl&gt;, sd_adj &lt;dbl&gt;, quant_adj &lt;dbl&gt;, z &lt;dbl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sample_summary</span>
<span class="co">#&gt; # A tibble: 16 × 3</span>
<span class="co">#&gt;    sample_name quantity_mean quant_adj</span>
<span class="co">#&gt;    &lt;chr&gt;               &lt;dbl&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt;  1 Sample 01           0.599     0.599</span>
<span class="co">#&gt;  2 Sample 02           1.05      1.05 </span>
<span class="co">#&gt;  3 Sample 03           1.37      1.39 </span>
<span class="co">#&gt;  4 Sample 04           1.69      1.62 </span>
<span class="co">#&gt;  5 Sample 05           0.903     0.888</span>
<span class="co">#&gt;  6 Sample 06           2.04      2.09 </span>
<span class="co">#&gt;  7 Sample 07           1.13      1.15 </span>
<span class="co">#&gt;  8 Sample 08           1.09      1.09 </span>
<span class="co">#&gt;  9 Sample 09           1.22      1.22 </span>
<span class="co">#&gt; 10 Sample 10           1.07      1.07 </span>
<span class="co">#&gt; 11 Sample 11           1.03      1.03 </span>
<span class="co">#&gt; 12 Sample 12           1.89      1.87 </span>
<span class="co">#&gt; 13 Sample 13           0.583     0.583</span>
<span class="co">#&gt; 14 Sample 14           1.22      1.17 </span>
<span class="co">#&gt; 15 Sample 15           0.713     0.713</span>
<span class="co">#&gt; 16 Sample 16           1.49      1.42 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $standard_summary</span>
<span class="co">#&gt; # A tibble: 5 × 4</span>
<span class="co">#&gt;   sample_name   dil quantity_mean quant_actual</span>
<span class="co">#&gt;   &lt;chr&gt;       &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Standard 01  0         6.80         6.80    </span>
<span class="co">#&gt; 2 Standard 02  9.27      0.680        0.734   </span>
<span class="co">#&gt; 3 Standard 03 12.2       0.0680       0.0603  </span>
<span class="co">#&gt; 4 Standard 04 10.6       0.00680      0.00568 </span>
<span class="co">#&gt; 5 Standard 05 13.6       0.000680     0.000417</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $outliers</span>
<span class="co">#&gt; # A tibble: 58 × 19</span>
<span class="co">#&gt; # Groups:   sample_name [22]</span>
<span class="co">#&gt;    sample_name task     quantity_mean concentration quantity quant_actual   dil</span>
<span class="co">#&gt;    &lt;chr&gt;       &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 Standard 01 STANDARD         NA              NA      6.80         6.80     0</span>
<span class="co">#&gt;  2 Standard 01 STANDARD         NA              NA      6.80         6.80     0</span>
<span class="co">#&gt;  3 Standard 01 STANDARD         NA              NA      6.80         6.80     0</span>
<span class="co">#&gt;  4 Sample 06   UNKNOWN           2.04         2039.     2.06         2.06    NA</span>
<span class="co">#&gt;  5 Sample 06   UNKNOWN           2.04         2039.     2.12         2.12    NA</span>
<span class="co">#&gt;  6 Sample 06   UNKNOWN           2.04         2039.     1.94         1.94    NA</span>
<span class="co">#&gt;  7 Sample 12   UNKNOWN           1.89         1893.     1.93         1.93    NA</span>
<span class="co">#&gt;  8 Sample 12   UNKNOWN           1.89         1893.     1.88         1.88    NA</span>
<span class="co">#&gt;  9 Sample 12   UNKNOWN           1.89         1893.     1.87         1.87    NA</span>
<span class="co">#&gt; 10 Sample 04   UNKNOWN           1.69         1694.     1.62         1.62    NA</span>
<span class="co">#&gt; # … with 48 more rows, and 12 more variables: slope &lt;dbl&gt;, efficiency &lt;dbl&gt;,</span>
<span class="co">#&gt; #   r2 &lt;dbl&gt;, ct &lt;dbl&gt;, no_po_mean &lt;dbl&gt;, no_po_sd &lt;dbl&gt;, keep &lt;lgl&gt;,</span>
<span class="co">#&gt; #   keep_temp &lt;lgl&gt;, mean_adj &lt;dbl&gt;, sd_adj &lt;dbl&gt;, quant_adj &lt;dbl&gt;, z &lt;dbl&gt;</span></code></pre></div>
<p>This output is generally not useful by itself. Using <code>pcr_lib_qc_plot_*</code> functions on it, however, generates plots that display valuable visual QC summaries</p>
<div id="standard-dilution-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#standard-dilution-plot" class="anchor"></a>Standard Dilution Plot</h2>
<p>Making standard curve for libraries requires making a serial dilution of standards. It is important we determine that this serial dilution was diluted properly, or the results calculated from it will be unreliable. The standard dilution plot helps with this:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lib_qc</span> |&gt; 
  <span class="fu"><a href="../reference/pcr_lib_qc_plot_dil.html">pcr_lib_qc_plot_dil</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="performing-lib-quant-qc_files/figure-html/unnamed-chunk-6-1.png" width="100%"></p>
<p>From this plot, we can see the relative dilution factors between samples. From this example, we can see a 9.3x dilution between the first and second, 12.2x dilution between second and third, etc. They gray dots represent where our blue dots should land if all the dilutions are perfect AND if efficiency is 100%. The red dots represent where the samples lie.</p>
<p>This plot can catch three sources of issues:</p>
<ol style="list-style-type: decimal">
<li>Inconsistent pipetting, which would show dilution factors widely varying from 10x or</li>
<li>Systematically incorrect pipetting, which would show dilutions consistently below or above 10x or</li>
<li>Poor efficiency of the enzyme, which would <em>appear</em> to show dilutions consistently above 10x.</li>
</ol>
<p>Determining efficiency issues vs consistently under-pipetting is impossible to determine with the data alone. Ensure you have calibrated pipettes and are practicing proper pipetting techniques to ensure not only consistent, but accurate volumes.</p>
</div>
<div id="standard-slope-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#standard-slope-plot" class="anchor"></a>Standard Slope Plot</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lib_qc</span> |&gt; 
  <span class="fu"><a href="../reference/pcr_lib_qc_plot_slope.html">pcr_lib_qc_plot_slope</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="performing-lib-quant-qc_files/figure-html/unnamed-chunk-7-1.png" width="100%"></p>
<p>In this plot, the log10 of the theoretical values of the standards is plotted against the Ct values of the standards. In a perfect world, we would expect that a standard 1/10th of the concentration would reach the same level of amplification in around 3.3 cycles. Why? Because in a perfect world, we expect perfect doubling of the product. <span class="math inline">\(2^{3.3}\approx 10\)</span>.</p>
<p>Thus, in a perfect world we expect to see a slope of -3.3, an <span class="math inline">\(R^2\)</span> of 1, and an efficiency of 100%.</p>
<p>Things are rarely perfect, however. 100% efficiency is an upper bound. Therefore, an efficiency &gt;80% is considered acceptable.</p>
<p>If there is an outlier in your standards it may make the efficiency artificially low or high. In some cases you can remove those standards and recalculate the slope to still get accurate concentrations, without having to redo the qPCR run:</p>
<ol style="list-style-type: decimal">
<li>Standards much more dilute than your sample concentrations are outliers</li>
<li>A technical replicate of a standard is an outlier</li>
</ol>
<p>One instances in which it is not recommended to simply remove the outliers: when standards that are within the range or above your sample concentrations. This is because a poor dilution done upstream of your samples will affect all concentrations downstream, making accurate determination of absolute library concentration impossible. If you are ever in doubt, you should probably bite the bullet and redo the qPCR.</p>
</div>
<div id="plot-outliers" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-outliers" class="anchor"></a>Plot Outliers</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lib_qc</span> |&gt; 
  <span class="fu"><a href="../reference/pcr_lib_qc_plot_outliers.html">pcr_lib_qc_plot_outliers</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 54 rows containing missing values (geom_text).</span>
<span class="co">#&gt; Warning: Removed 1 rows containing missing values (geom_point).</span></code></pre></div>
<p><img src="performing-lib-quant-qc_files/figure-html/unnamed-chunk-8-1.png" width="100%"></p>
<p>It’s often best to remove technical replicate outliers in order to obtain an accurate estimate of concentration. A point is deemed an outlier if it is &gt;3Z away from the mean of the other two. Shown above, the outliers are in gray, and the zone of inclusion is in blue. Particularly egregious outliers are shown with (&lt;&lt;&lt;) or (&gt;&gt;&gt;) and the number of standard deviations away they are. In the instance above, 463Z away! New estimates, sans these outliers, are found in the <code>quant_adj</code> column of <code>sample_summary</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lib_qc</span><span class="op">$</span><span class="va">sample_summary</span>
<span class="co">#&gt; # A tibble: 16 × 3</span>
<span class="co">#&gt;    sample_name quantity_mean quant_adj</span>
<span class="co">#&gt;    &lt;chr&gt;               &lt;dbl&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt;  1 Sample 01           0.599     0.599</span>
<span class="co">#&gt;  2 Sample 02           1.05      1.05 </span>
<span class="co">#&gt;  3 Sample 03           1.37      1.39 </span>
<span class="co">#&gt;  4 Sample 04           1.69      1.62 </span>
<span class="co">#&gt;  5 Sample 05           0.903     0.888</span>
<span class="co">#&gt;  6 Sample 06           2.04      2.09 </span>
<span class="co">#&gt;  7 Sample 07           1.13      1.15 </span>
<span class="co">#&gt;  8 Sample 08           1.09      1.09 </span>
<span class="co">#&gt;  9 Sample 09           1.22      1.22 </span>
<span class="co">#&gt; 10 Sample 10           1.07      1.07 </span>
<span class="co">#&gt; 11 Sample 11           1.03      1.03 </span>
<span class="co">#&gt; 12 Sample 12           1.89      1.87 </span>
<span class="co">#&gt; 13 Sample 13           0.583     0.583</span>
<span class="co">#&gt; 14 Sample 14           1.22      1.17 </span>
<span class="co">#&gt; 15 Sample 15           0.713     0.713</span>
<span class="co">#&gt; 16 Sample 16           1.49      1.42</span></code></pre></div>
<p>These can be visualized using <code>pcr_lib_qc_conc</code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lib_qc</span> |&gt; 
  <span class="fu"><a href="../reference/pcr_lib_qc_plot_conc.html">pcr_lib_qc_plot_conc</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="performing-lib-quant-qc_files/figure-html/unnamed-chunk-10-1.png" width="100%"> This plot shows the unadjusted concentrations in gray, and the concentrations after outlier removal in blue.</p>
<p>A full HTML report can be produced by running <code>pcr_lib_qc_report</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lib_qc</span> |&gt; 
  <span class="fu">amplify</span><span class="fu">::</span><span class="fu"><a href="../reference/pcr_lib_qc_report.html">pcr_lib_qc_report</a></span><span class="op">(</span><span class="st">"path/to/file.html"</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Kai Aragaki.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
