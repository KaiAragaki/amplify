---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# amplify <img src='man/figures/logo.png' align="right" height="138" />
<!-- badges: start -->

<!-- badges: end -->

**amplify** automates routine pcr-based tasks - including plate planning, dilution making, visualizing, and analyzing - so rather than thinking about your experiments themselves, you can think about what your experiments *mean*.

## Installation

You can install this package from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("KaiAragaki/amplify")
```
## Tidying qPCR data

Data from the QuantStudio software is exported in a fairly non-standard format:

```{r untidy_pcr}
library(amplify)
library(readxl)
library(knitr)
library(dplyr)

untidy_file_path <- system.file("extdata", "untidy-pcr-example.xls", package = "amplify")

untidy_file_path |> 
  read_excel() |> 
  head() |> 
  kable()
```

amplify provides `pcr_tidy` to automatically tidy these files:

```{r tidy_pcr}
tidy_pcr <- untidy_file_path |> 
  pcr_tidy()

tidy_pcr |> 
  head() |> 
  knitr::kable()
```

This can be done for both $\Delta\Delta$Ct qPCR or standard curve qPCR.

## Plotting qPCR results

Tidied results can be plotted using `pcr_plot`

```{r pcr_plot}
tidy_pcr |> 
  pcr_plot()
```

Additionally, overviews of plate features can be done using `pcr_plate`

```{r}
tidy_pcr |> 
  pcr_plate_view(target_name)
```

More details can be found in the "Analyzing ddCt qPCR with amplify" vignette.

## Library Preparation Quantification

### Library Preparation Quantification Calculation

RNA library preparation results output from Quantstudio can be tidied using `pcr_tidy`:

```{r}
untidy_lib_path <- system.file("extdata", "untidy-standard-curve.xlsx", package = "amplify")
tidy_lib <- pcr_tidy(untidy_lib_path) 
tidy_lib |> head() |> kable()
```

Calculating the concentration of library can be performed using `pcr_lib_calc`:

```{r}
calc_lib <- tidy_lib |> 
  pcr_lib_calc()

calc_lib |> select(task, sample_name, concentration) |> head() |> kable()
```
### Library preparation quantification quality control

We can generate useful plots to determine the quality of the quantification run by first using `pcr_lib_qc`:

```{r}
qc <- calc_lib |> 
  pcr_lib_qc()
qc
```
These data, by themselves, are not particularly useful. However, they can be used for more elucidative downstream analyses like `pcr_qc_report`

```{r}
# Generates a file - not run
# qc |> pcr_lib_qc_report()
```
